@model PF_Pach_OS.Models.Proveedore

@{
    ViewData["Title"] = "Create";
    Layout = null;
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
}

<div class="row">
    <div>
        <form asp-action="Create" id="formulario" >
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <div class="form-group">
                <label asp-for="TipoDocumento" class="control-label">Tipo de Documento</label>
                <select asp-for="TipoDocumento" class="form-control">
                    <option value="NIT">NIT</option>
                    <option value="Cédula">Cédula</option>
                </select>
            </div>
            <div class="form-group">
                <label asp-for="Nit" class="control-label"></label>
                <input asp-for="Nit" class="form-control" maxlength="10" required />
                <span id="nitResult" class="text-danger"></span>
                <span asp-validation-for="Nit" class="text-danger"></span>
                <div class="valid-feedback">
                </div>
                <span asp-validation-for="Nit" class="text-danger"></span>
            </div>

            <div class="form-group">
                <label asp-for="NomLocal" class="control-label">Nombre Local</label>
                <input asp-for="NomLocal" class="form-control" maxlength="30" required />
                <div class="invalid-feedback" id="nomlocal-feedback">
                    Por favor rellene el campo.
                </div>
                <div class="valid-feedback">
                </div>
                <span asp-validation-for="NomLocal" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Direccion" class="control-label"></label>
                <input asp-for="Direccion" class="form-control" maxlength="30" required />
                <div class="invalid-feedback">
                    Por favor ingrese la direccion correcta.
                </div>
                <div class="valid-feedback">
                </div>
                <span asp-validation-for="Direccion" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Telefono" class="control-label"></label>
                <input asp-for="Telefono" class="form-control" maxlength="10" required />
                <div class="invalid-feedback">
                    Por favor ingrese el telefono
                </div>
                <div class="valid-feedback">
                </div>
                <span asp-validation-for="Telefono" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Correo" class="control-label"></label>
                <input asp-for="Correo" class="form-control" maxlength="30" required />
                <div class="invalid-feedback">
                    Por favor ingrese el correo
                </div>
                <div class="valid-feedback">
                </div>
                <span asp-validation-for="Correo" class="text-danger"></span>
            </div>
            <div class="form-group">
                <button class="btn btn-primary botones-agregar" type="submit" id="btnRegistrar">Registrar</button>
            </div>
        </form>
    </div>
</div>

<script>

    (function () {
        'use strict';
        window.addEventListener('load', function () {
            var forms = document.getElementsByClassName('needs-validation');
            var validation = Array.prototype.filter.call(forms, function (form) {
                form.addEventListener('submit', function (event) {
                    if (form.checkValidity() === false) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
        }, false);
    })();
    }
</script>
    <script>
    $('#Nit').on('input', function () {
        var nit = $(this).val();
        if (nit) {
            $.ajax({
                type: 'POST',
                url: '@Url.Action("IsNitAvailable", "Proveedores")',
                data: { Nit: nit },
                success: function (data) {
                    if (data) {
                        $('#nitResult').text('');
                        $('#nit-validation-message').hide();
                        $('#Nit').removeClass('is-invalid').addClass('is-valid');
                        $('#btnRegistrar').prop('disabled', false); 
                    } else {
                        $('#nitResult').text('Documento registrado.');
                        $('#nit-validation-message').show();
                        $('#Nit').removeClass('is-valid').addClass('is-invalid');
                        $('#btnRegistrar').prop('disabled', true); 
                    }
                }
            });
        }
    });
    </script>



@*<div>
    <a asp-action="Index">Back to List</a>
</div>*@
<script src="~/js/Proveedores/Validaciones.js"></script>
@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
